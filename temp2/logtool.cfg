##config file for CMCC network monitoring (demo only)
## (v0.1)

<GlobalSettings>
    online          1       
#   repeat          on
#   times           1   
    ziplog          0
    size2zip        100000
    sleep           1
    rounds          10000       
#   debug           0
    log_dir         port25%t
    checklog_file   checklogfile%h%t.txt    
#   cmdlog_file     rml.txt         
    checkonhit_file found%h%t.txt
    timing          remote
#   sendemail       on
        smtpserver      smtp.sina.com.cn
        emailfrom       routermonitor <routermonitor@sina.com>
        emailfakefrom   routermonitor@ericsson.com
        emailto     ericsson team <itestitest@hotmail.com>
        emailreplyto    ericsson team <ping.song@ericsson.com>
        emailsubj       ping issue and vrrp state change report
    
</GlobalSettings>


<LoginInfo>
#   HK-LAB      t1:192.168.19.129 u1:admin p1:redback123
    bjlab	t1:172.16.125.103 u1:admin p1:redback
    CQLAB       t1:10.190.3.220 u1:admin p1:redback
    BKP-RI      t1:10.252.75.22 u1:root p1:root t2:10.251.130.50 u2:redback p2:redback e2:redback
    BKP-RII     t1:10.252.75.22 u1:root p1:root t2:10.251.130.51 u2:redback p2:redback e2:redback
    BDK-RI      t1:10.252.75.22 u1:root p1:root t2:10.251.130.18 u2:redback p2:redback e2:redback
    BDK-RII     t1:10.252.75.22 u1:root p1:root t2:10.251.130.19 u2:redback p2:redback e2:redback
    e320-1 	t1:127.0.0.1 u1:temp p1:temp123 t2:172.25.84.204 u2:en p2:whatever
</LoginInfo>

<Data all>
    #some pre-checking
    precheck1210    show_ver={show version}
    precheck1220    show_clock={show clock}
    precheck910 	pc1={end}
    precheck920 	pc2={term wid 400}
    precheck930 	pc3={term len 0}
    
#    #create a dummy clacl
#    precheck1000 	virpe1={vir pe1}
#    precheck1005    	conft={conf t} 
#    precheck1010 	dummyclacl={classifier-list dummyclacl ip host 1.1.1.1 host 2.2.2.2}
#    precheck1020 	pr4={end}

    #ping monitor
    #check1450   ping_result1={ping 10.251.133.199 20 flood}:{(\.\.\.\.\.)}
    #check1460   ping_result2={ping 10.251.135.199 20 flood}:{(\.\.\.\.\.)}
    #check1470   ping_result3={ping 10.251.137.199 20 flood}:{(\.\.\.\.\.)}  
    #check1480   ping_result4={ping 10.251.139.199 20 flood}:{(\.\.\.\.\.)}  



#############################################################################
# rep effort1
#############################################################################

    #apply the dummy clacl into policy
#    check1000 		c00={!!!start a new round!!!}
#    check1005 		c01={vir pe1}
#    check1010 		c0={conf t}
#    check1020 		c1={ip policy-list DENY_DHCP}
#    check1030	    	c2={classifier-group dummyclacl prec 6 }
#    check1040		c3={forward }
#    check1050		c4={end}
#
#    //give it some time and verify it
#    check1060		c5={sleep 1}
#    check1070		c6={show policy-list DENY_DHCP}
#
#
#    //remove it
#    check1080		c7={conf t}
#    check1090 		c8={ip policy-list DENY_DHCP}
#    check1100		c9={no classifier-group dummyclacl }
#    check1110 		c10={end}
#
#    //give it some time and verify it
#    check1120	c11={sleep 1}
#    check1130	c12={show policy-list DENY_DHCP}
#
#    //baseline counters
#    #check1140	c13={base ip int ip19000009.mpls.ip}
    check1135   c114={vir pe2}
    check1137 	c113={!!baseline counters!!}
    check1140 	c13={base ip int g1/1/3.100}
    check1150 	c14={sleep 2}
#
#    //check the traffic
#    #check1160	c15={show ip int g1/0/3.1930035 delta}:{classifier-group jnpr-to25 entry 1\n\s+0 packets, 0 bytes}
#    #check1160	c15={show ip int ip19000009.mpls.ip}:{classifier-group jnpr-to25 entry 1\n\s+\d+ packets, \d+ bytes}
    check1155 	c115={!!check p25 traffic at egress router uplink port!!}
    check1160	c15={show ip int g1/1/3.100 delta}:{classifier-group jnpr-to25 entry 4\n\s+0 packets, 0 bytes\n\s*forward}
#    check1170 	c16={!!!end a round!!!}

#############################################################################
# rep effort2: customer's log
# this is to add some background configuration activities which might (not)
# contribute to the issue
#############################################################################

    check2900   d10={!policy touch:round start!}
    check3000   d100={vir vol}
    check3010   d110={conf t}
    check3015   d115={ip policy-list DATA:ONLY}
    check3020   d120={classifier-group IP-TRAFFIC precedence 1}
    check3025   d125={forward}
    check3030   d130={no classifier-group VIDEO-TRAFFIC precedence 30}
    check3035   d135={!}
    check3040   d140={ip policy-list VIDEO:ONLY}
    check3045   d145={classifier-group IP-TRAFFIC precedence 1}
    check3050   d150={forward}
    check3055   d155={no classifier-group VIDEO-TRAFFIC precedence 20}
    check3060   d160={!}
    check3065   d165={ip policy-list DENY_DHCP}
    check3070   d170={classifier-group IP-TRAFFIC precedence 1}
    check3075   d175={forward}
    check3080   d180={no classifier-group VIDEO-TRAFFIC precedence 20}
    check3085   d185={!}
    check3090   d190={ip policy-list VIS-PBR}
    check3095   d195={classifier-group IP-TRAFFIC precedence 1}
    check3100   d200={forward}
    check3105   d205={no classifier-group VIDEO-TRAFFIC precedence 20}
    check3110   d210={!}
    check3115   d215={ip policy-list STATIC:VIS-PBR}
    check3120   d220={classifier-group IP-TRAFFIC precedence 1}
    check3125   d225={forward}
    check3130   d230={no classifier-group VIDEO-TRAFFIC precedence 20}
    check3135   d235={!}
    check3140   d240={!}
    check3145   d245={no ip classifier-list VIDEO-PUMPS}
    check3150   d250={no ip classifier-list VIDEO-TRAFFIC}
    check3155   d255={!}
    check3160   d260={ip classifier-list VIDEO-TRAFFIC ip any 70.110.95.0 0.0.0.255}
    check3165   d265={ip classifier-list VIDEO-TRAFFIC ip any 71.169.254.0 0.0.0.255}
    check3170   d270={ip classifier-list VIDEO-TRAFFIC ip any 71.122.255.0 0.0.0.255}
    check3175   d275={ip classifier-list VIDEO-TRAFFIC ip any 96.228.255.0 0.0.0.255}
    check3180   d280={ip classifier-list VIDEO-TRAFFIC ip any 71.118.255.0 0.0.0.255}
    check3185   d285={ip classifier-list VIDEO-TRAFFIC ip any 96.229.255.0 0.0.0.255}
    check3190   d290={ip classifier-list VIDEO-TRAFFIC ip any 71.246.255.0 0.0.0.255}
    check3195   d295={ip classifier-list VIDEO-TRAFFIC ip any 96.231.255.0 0.0.0.255}
    check3200   d300={ip classifier-list VIDEO-TRAFFIC ip any 71.245.255.0 0.0.0.255}
    check3205   d305={ip classifier-list VIDEO-TRAFFIC ip any 96.239.127.0 0.0.0.255}
    check3210   d310={ip classifier-list VIDEO-TRAFFIC ip any 71.245.239.0 0.0.0.255}
    check3215   d315={ip classifier-list VIDEO-TRAFFIC ip any 96.237.255.0 0.0.0.255}
    check3220   d320={ip classifier-list VIDEO-TRAFFIC ip any 72.76.255.0 0.0.0.255}
    check3225   d325={ip classifier-list VIDEO-TRAFFIC ip any 96.240.31.0 0.0.0.255}
    check3230   d330={ip classifier-list VIDEO-TRAFFIC ip any 72.78.255.0 0.0.0.255}
    check3235   d335={ip classifier-list VIDEO-TRAFFIC ip any 96.245.255.0 0.0.0.255}
    check3240   d340={ip classifier-list VIDEO-TRAFFIC ip any 71.251.238.0 0.0.0.255}
    check3245   d345={ip classifier-list VIDEO-TRAFFIC ip any 71.176.255.0 0.0.0.255}
    check3250   d350={ip classifier-list VIDEO-TRAFFIC ip any 71.188.191.0 0.0.0.255}
    check3255   d355={ip classifier-list VIDEO-TRAFFIC ip any 96.238.255.0 0.0.0.255}
    check3260   d360={ip classifier-list VIDEO-TRAFFIC ip any 71.182.255.0 0.0.0.255}
    check3265   d365={ip classifier-list VIDEO-TRAFFIC ip any 71.182.254.0 0.0.0.255}
    check3270   d370={ip classifier-list VIDEO-TRAFFIC ip any 71.102.122.0 0.0.1.255}
    check3275   d375={ip classifier-list VIDEO-TRAFFIC ip any 96.240.158.0 0.0.1.255}
    check3280   d380={ip classifier-list VIDEO-TRAFFIC ip any 71.186.254.0 0.0.1.255}
    check3285   d385={ip classifier-list VIDEO-TRAFFIC ip any 96.229.254.0 0.0.0.255}
    check3290   d390={ip classifier-list VIDEO-TRAFFIC ip any 96.231.254.0 0.0.0.255}
    check3295   d395={ip classifier-list VIDEO-TRAFFIC ip any 96.239.126.0 0.0.0.255}
    check3300   d400={ip classifier-list VIDEO-TRAFFIC ip any 96.237.254.0 0.0.0.255}
    check3305   d405={ip classifier-list VIDEO-TRAFFIC ip any 96.242.255.0 0.0.0.255}
    check3310   d410={ip classifier-list VIDEO-TRAFFIC ip any 96.238.254.0 0.0.0.255}
    check3315   d415={ip classifier-list VIDEO-TRAFFIC ip any 71.97.116.0 0.0.0.255}
    check3320   d420={ip classifier-list VIDEO-TRAFFIC ip any 96.228.254.0 0.0.0.255}
    check3325   d425={ip classifier-list VIDEO-TRAFFIC ip any 71.176.254.0 0.0.0.255}
    check3330   d430={ip classifier-list VIDEO-TRAFFIC ip any 71.182.253.0 0.0.0.255}
    check3335   d435={ip classifier-list VIDEO-TRAFFIC ip any 96.225.255.0 0.0.0.255}
    check3340   d440={ip classifier-list VIDEO-TRAFFIC ip any 96.240.127.0 0.0.0.255}
    check3345   d445={ip classifier-list VIDEO-TRAFFIC ip any 96.240.157.0 0.0.0.255}
    check3350   d450={ip classifier-list VIDEO-TRAFFIC ip any 96.243.63.0 0.0.0.255}
    check3355   d455={ip classifier-list VIDEO-TRAFFIC ip any 74.106.128.0 0.0.31.255}
    check3360   d460={!}
    check3365   d465={!}
    check3370   d470={ip policy-list DATA:ONLY}
    check3375   d475={classifier-group VIDEO-TRAFFIC precedence 30}
    check3380   d480={filter}
    check3385   d485={no classifier-group IP-TRAFFIC precedence 1}
    check3390   d490={!}
    check3395   d495={ip policy-list VIDEO:ONLY}
    check3400   d500={classifier-group VIDEO-TRAFFIC precedence 20}
    check3405   d505={rate-limit-profile video-upstream}
    check3410   d510={forward}
    check3415   d515={classifier-group IP-TRAFFIC precedence 500}
    check3420   d520={filter}
    check3425   d525={!}
    check3430   d530={ip policy-list DENY_DHCP}
    check3435   d535={classifier-group VIDEO-TRAFFIC precedence 20}
    check3440   d540={filter}
    check3445   d545={no classifier-group IP-TRAFFIC precedence 1}
    check3450   d550={!}
    check3455   d555={ip policy-list VIS-PBR}
    check3460   d560={classifier-group VIDEO-TRAFFIC precedence 20}
    check3465   d565={rate-limit-profile video-upstream}
    check3470   d570={no classifier-group IP-TRAFFIC precedence 1}
    check3475   d575={!}
    check3480   d580={ip policy-list STATIC:VIS-PBR}
    check3485   d585={classifier-group VIDEO-TRAFFIC precedence 20}
    check3490   d590={rate-limit-profile video-upstream}
    check3495   d595={no classifier-group IP-TRAFFIC precedence 1}
    check3500   d600={!}
    check3505   d605={snmp-server contact juniper-FTTP-VOD-V5.0.24}

     #wait 1s and continue{{{1
    check3510   d610={sleep 1}

    check3600   d710={ip policy-list DATA:ONLY}
    check3605   d715={classifier-group IP-TRAFFIC precedence 1}
    check3610   d720={forward}
    check3615   d725={no classifier-group VIDEO-TRAFFIC precedence 30}
    check3620   d730={!}
    check3625   d735={ip policy-list VIDEO:ONLY}
    check3630   d740={ classifier-group IP-TRAFFIC precedence 1}
    check3635   d745={ forward}
    check3640   d750={no classifier-group VIDEO-TRAFFIC precedence 20}
    check3645   d755={!}
    check3650   d760={ip policy-list DENY_DHCP}
    check3655   d765={ classifier-group IP-TRAFFIC precedence 1}
    check3660   d770={ forward}
    check3665   d775={no classifier-group VIDEO-TRAFFIC precedence 20}
    check3670   d780={!}
    check3675   d785={ip policy-list VIS-PBR}
    check3680   d790={ classifier-group IP-TRAFFIC precedence 1}
    check3685   d795={ forward}
    check3690   d800={no classifier-group VIDEO-TRAFFIC precedence 20}
    check3695   d805={!}
    check3700   d810={ip policy-list STATIC:VIS-PBR}
    check3705   d815={ classifier-group IP-TRAFFIC precedence 1}
    check3710   d820={ forward}
    check3715   d825={no classifier-group VIDEO-TRAFFIC precedence 20}
    check3720   d830={!}
    check3725   d835={!}
    check3730   d840={no ip classifier-list VIDEO-PUMPS}
    check3735   d845={no ip classifier-list VIDEO-TRAFFIC}
    check3740   d850={!}
    check3745   d855={ip classifier-list VIDEO-PUMPS ip 70.110.95.0 0.0.0.255 any}
    check3750   d860={ip classifier-list VIDEO-PUMPS ip 71.122.255.0 0.0.0.255 any}
    check3755   d865={ip classifier-list VIDEO-PUMPS ip 71.118.255.0 0.0.0.255 any}
    check3760   d870={ip classifier-list VIDEO-PUMPS ip 71.246.255.0 0.0.0.255 any}
    check3765   d875={ip classifier-list VIDEO-PUMPS ip 71.245.255.0 0.0.0.255 any}
    check3770   d880={ip classifier-list VIDEO-PUMPS ip 71.245.239.0 0.0.0.255 any}
    check3775   d885={ip classifier-list VIDEO-PUMPS ip 72.76.255.0 0.0.0.255 any}
    check3780   d890={ip classifier-list VIDEO-PUMPS ip 72.78.255.0 0.0.0.255 any}
    check3785   d895={ip classifier-list VIDEO-PUMPS ip 71.251.238.0 0.0.0.255 any}
    check3790   d900={ip classifier-list VIDEO-PUMPS ip 71.188.191.0 0.0.0.255 any}
    check3795   d905={ip classifier-list VIDEO-PUMPS ip 71.169.254.0 0.0.0.255 any}
    check3800   d910={ip classifier-list VIDEO-PUMPS ip 96.228.255.0 0.0.0.255 any}
    check3805   d915={ip classifier-list VIDEO-PUMPS ip 96.229.255.0 0.0.0.255 any}
    check3810   d920={ip classifier-list VIDEO-PUMPS ip 96.231.255.0 0.0.0.255 any}
    check3815   d925={ip classifier-list VIDEO-PUMPS ip 96.239.127.0 0.0.0.255 any}
    check3820   d930={ip classifier-list VIDEO-PUMPS ip 96.237.255.0 0.0.0.255 any}
    check3825   d935={ip classifier-list VIDEO-PUMPS ip 96.240.31.0 0.0.0.255 any}
    check3830   d940={ip classifier-list VIDEO-PUMPS ip 71.176.255.0 0.0.0.255 any}
    check3835   d945={ip classifier-list VIDEO-PUMPS ip 96.238.255.0 0.0.0.255 any}
    check3840   d950={ip classifier-list VIDEO-PUMPS ip 71.182.254.0 0.0.0.255 any}
    check3845   d955={ip classifier-list VIDEO-PUMPS ip 72.95.124.0 0.0.0.255 any}
    check3850   d960={ip classifier-list VIDEO-PUMPS ip 96.245.255.0 0.0.0.255 any}
    check3855   d965={ip classifier-list VIDEO-PUMPS ip 71.102.122.0 0.0.1.255 any}
    check3860   d970={ip classifier-list VIDEO-PUMPS ip 96.240.158.0 0.0.1.255 any}
    check3865   d975={ip classifier-list VIDEO-PUMPS ip 71.186.254.0 0.0.1.255 any}
    check3870   d980={ip classifier-list VIDEO-PUMPS ip 96.238.254.0 0.0.0.255 any}
    check3875   d985={!}
    check3880   d990={ip classifier-list VIDEO-TRAFFIC ip any 70.110.95.0 0.0.0.255}
    check3885   d995={ip classifier-list VIDEO-TRAFFIC ip any 71.122.255.0 0.0.0.255}
    check3890   d1000={ip classifier-list VIDEO-TRAFFIC ip any 71.118.255.0 0.0.0.255}
    check3895   d1005={ip classifier-list VIDEO-TRAFFIC ip any 71.246.255.0 0.0.0.255}
    check3900   d1010={ip classifier-list VIDEO-TRAFFIC ip any 71.245.255.0 0.0.0.255}
    check3905   d1015={ip classifier-list VIDEO-TRAFFIC ip any 71.245.239.0 0.0.0.255}
    check3910   d1020={ip classifier-list VIDEO-TRAFFIC ip any 72.76.255.0 0.0.0.255}
    check3915   d1025={ip classifier-list VIDEO-TRAFFIC ip any 72.78.255.0 0.0.0.255}
    check3920   d1030={ip classifier-list VIDEO-TRAFFIC ip any 71.251.238.0 0.0.0.255}
    check3925   d1035={ip classifier-list VIDEO-TRAFFIC ip any 71.188.191.0 0.0.0.255}
    check3930   d1040={ip classifier-list VIDEO-TRAFFIC ip any 71.169.254.0 0.0.0.255}
    check3935   d1045={ip classifier-list VIDEO-TRAFFIC ip any 96.228.255.0 0.0.0.255}
    check3940   d1050={ip classifier-list VIDEO-TRAFFIC ip any 96.229.255.0 0.0.0.255}
    check3945   d1055={ip classifier-list VIDEO-TRAFFIC ip any 96.231.255.0 0.0.0.255}
    check3950   d1060={ip classifier-list VIDEO-TRAFFIC ip any 96.239.127.0 0.0.0.255}
    check3955   d1065={ip classifier-list VIDEO-TRAFFIC ip any 96.237.255.0 0.0.0.255}
    check3960   d1070={ip classifier-list VIDEO-TRAFFIC ip any 96.240.31.0 0.0.0.255}
    check3965   d1075={ip classifier-list VIDEO-TRAFFIC ip any 71.176.255.0 0.0.0.255}
    check3970   d1080={ip classifier-list VIDEO-TRAFFIC ip any 96.238.255.0 0.0.0.255}
    check3975   d1085={ip classifier-list VIDEO-TRAFFIC ip any 71.182.254.0 0.0.0.255}
    check3980   d1090={ip classifier-list VIDEO-TRAFFIC ip any 72.95.124.0 0.0.0.255}
    check3985   d1095={ip classifier-list VIDEO-TRAFFIC ip any 96.245.255.0 0.0.0.255}
    check3990   d1100={ip classifier-list VIDEO-TRAFFIC ip any 71.102.122.0 0.0.1.255}
    check3995   d1105={ip classifier-list VIDEO-TRAFFIC ip any 96.240.158.0 0.0.1.255}
    check4000   d1110={ip classifier-list VIDEO-TRAFFIC ip any 71.186.254.0 0.0.1.255}
    check4005   d1115={ip classifier-list VIDEO-TRAFFIC ip any 96.238.254.0 0.0.0.255}
    check4010   d1120={ip classifier-list VIDEO-TRAFFIC ip any 71.102.122.0 0.0.0.255}
    check4015   d1125={ip classifier-list VIDEO-TRAFFIC ip any 71.102.123.0 0.0.0.255}
    check4020   d1130={ip classifier-list VIDEO-TRAFFIC ip any 71.176.254.0 0.0.0.255}
    check4025   d1135={ip classifier-list VIDEO-TRAFFIC ip any 71.182.253.0 0.0.0.255}
    check4030   d1140={ip classifier-list VIDEO-TRAFFIC ip any 71.182.255.0 0.0.0.255}
    check4035   d1145={ip classifier-list VIDEO-TRAFFIC ip any 71.186.254.0 0.0.0.255}
    check4040   d1150={ip classifier-list VIDEO-TRAFFIC ip any 71.186.255.0 0.0.0.255}
    check4045   d1155={ip classifier-list VIDEO-TRAFFIC ip any 71.97.116.0 0.0.0.255}
    check4050   d1160={ip classifier-list VIDEO-TRAFFIC ip any 72.95.125.0 0.0.0.255}
    check4055   d1165={ip classifier-list VIDEO-TRAFFIC ip any 74.106.128.0 0.0.31.255}
    check4060   d1170={ip classifier-list VIDEO-TRAFFIC ip any 96.225.255.0 0.0.0.255}
    check4065   d1175={ip classifier-list VIDEO-TRAFFIC ip any 96.228.254.0 0.0.0.255}
    check4070   d1180={ip classifier-list VIDEO-TRAFFIC ip any 96.229.254.0 0.0.0.255}
    check4075   d1185={ip classifier-list VIDEO-TRAFFIC ip any 96.231.254.0 0.0.0.255}
    check4080   d1190={ip classifier-list VIDEO-TRAFFIC ip any 96.237.254.0 0.0.0.255}
    check4085   d1195={ip classifier-list VIDEO-TRAFFIC ip any 96.239.126.0 0.0.0.255}
    check4090   d1200={ip classifier-list VIDEO-TRAFFIC ip any 96.240.127.0 0.0.0.255}
    check4095   d1205={ip classifier-list VIDEO-TRAFFIC ip any 96.240.157.0 0.0.0.255}
    check4100   d1210={ip classifier-list VIDEO-TRAFFIC ip any 96.240.158.0 0.0.0.255}
    check4105   d1215={ip classifier-list VIDEO-TRAFFIC ip any 96.240.159.0 0.0.0.255}
    check4110   d1220={ip classifier-list VIDEO-TRAFFIC ip any 96.242.255.0 0.0.0.255}
    check4115   d1225={ip classifier-list VIDEO-TRAFFIC ip any 96.243.63.0 0.0.0.255}
    check4120   d1230={! }
    check4125   d1235={ip policy-list DATA:ONLY}
    check4130   d1240={classifier-group VIDEO-TRAFFIC precedence 30}
    check4135   d1245={filter}
    check4140   d1250={no classifier-group IP-TRAFFIC precedence 1}
    check4145   d1255={!}
    check4150   d1260={ip policy-list VIDEO:ONLY}
    check4155   d1265={classifier-group VIDEO-TRAFFIC precedence 20}
    check4160   d1270={  rate-limit-profile video-upstream}
    check4165   d1275={  forward}
    check4170   d1280={classifier-group IP-TRAFFIC precedence 500}
    check4175   d1285={  filter}
    check4180   d1290={!}
    check4185   d1295={ip policy-list DENY_DHCP}
    check4190   d1300={classifier-group VIDEO-TRAFFIC precedence 20}
    check4195   d1305={filter}
    check4200   d1310={no classifier-group IP-TRAFFIC precedence 1}
    check4205   d1315={!}
    check4210   d1320={ip policy-list VIS-PBR}
    check4215   d1325={classifier-group VIDEO-TRAFFIC precedence 20}
    check4220   d1330={rate-limit-profile video-upstream}
    check4225   d1335={no classifier-group IP-TRAFFIC precedence 1}
    check4230   d1340={!}
    check4235   d1345={ip policy-list STATIC:VIS-PBR}
    check4240   d1350={classifier-group VIDEO-TRAFFIC precedence 20}
    check4245   d1355={rate-limit-profile video-upstream}
    check4250   d1360={no classifier-group IP-TRAFFIC precedence 1}
    check4255   d1365={!}
    check4260   d1370={snmp-server contact juniper-FTTP-VOD-V5.0.24}
    check4265   d1375={end}
    check4270   d1400={!!policy touch:round end!!}


    #arp table self-entry monitor
    #check1490   show_arp={show arp}:{.*(10.251.132.201).*(10.251.134.201).*(10.251.136.201).*(10.251.138.201)}
    
    #port state monitor
#   check1600   all_port_up={show port}:{(1\/1\s+\w+\s+Up)\s+(2\/1\s+\w+\s+Up)\s+(3\/1\s+\w+\s+Up)\s+(4\/1\s+\w+\s+Up)}

    #vrrp state monitor
    #check1500   show_vrrp={show vrrp}:{state.*?\n}
    

    #this part monitors absolute status: 
    #   if calculation from all our capture results end up with ture,go dotrue  
    #
    #if either ping failed, no port down, but the specific arp entry miss, we think it's an issue
    #checkstate  ((ping_result1 or ping_result2 or ping_result3 or ping_result4) and (not show_arp))
    checkstate  	c15
    
    #this part monitors relative changes:
    #   if any capture has changed comparing with last result and,
    #   if calculations of all changes end up with true, go dotrue
    #
    #if vrrp state or port state change, we think it's an check point
    #checkchange 	c15
    
    #checkfinal:    final decision about weather need to check further(dotrue) or not(dofalse)
    #checkfinal  (checkstate or checkchange)
    #checkfinal 	(not checkchange)
    checkfinal 		checkstate
    
    #detail further checking when the monitored conditions emerge
        #detail check for ping/arp issue 
        #dotrue90    alert={!!!!ping failure detected!!!!}   #put a note in logfile
	dotrue1000 	alert={!!!!port 25 failure detected!!!!will exit...}
        dotrue1010   	show_clock={show clock}         #check time
	dotrue1020 	exit={exit}
	dotrue1030 	exit={exit}
    #dotrue110   show_arp_all={show arp all}     #check arp table
    #dotrue120   show_arp_int={show arp interface}
    #dotrue130   show_arp_cct={show arp circuit}
    #dotrue140   show_ism_client={show ism client arp log det cct handle 1/1:1023:63/1/2/5}
    #dotrue150   show_ism_client={show ism client arp log det cct handle 2/1:1023:63/1/2/9}
    #dotrue160   show_ism_client={show ism client arp log det cct handle 3/1:1023:63/1/2/13}
    #dotrue170   show_ism_client={show ism client arp log det cct handle 4/1:1023:63/1/2/17}
    
    #further check path to RII
    #dotrue180   ping_BKP_RII={ping 192.168.251.142 100 flood}
    #dotrue185   ping_BDK_RI={ping 192.168.251.157 100 flood}
    #dotrue186   ping_BDK_RII={ping 192.168.251.132 100 flood}
    
    #further check ospf/route/vrrp statistics
    #dotrue190   ospf={show ospf nei}
    #dotrue200   route={show ip route}
    #dotrue210   show_vrrp_tran={show vrrp stat}
    
    #further port details checking(tx/rx power) if port down
    #dotrue220       show_port_det={show port detail}

    #if the monitored conditions doesn't appear, no need to check anything      
        dofalse100  nohit={!!no hit,continue...}
	dofalse110  show_clock={show clock}
                
        #some 'post-checking' after all rounds(checking in loop) finish
        postcheck100    show_ver={show clock}
        
</Data all>


<PerlHandle>
#   print "time is now:\n$show_clock_all";
</PerlHandle>

<SimpleReport>
</SimpleReport>
